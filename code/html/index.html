<!DOCTYPE html>
<html lang="">
    <head>
        <title>ESPurna 0.0.0</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link type="image" rel="icon" href="favicon.ico" inline>

        <link rel="stylesheet" href="vendor/pure-2.0.3.min.css" inline>
        <link rel="stylesheet" href="vendor/pure-grids-responsive-2.0.3.min.css" inline>
        <link rel="stylesheet" href="vendor/side-menu.css" inline>
        <link rel="stylesheet" href="custom.css" inline>

        <script src="custom.js" inline></script>
        <!-- removeIf(!light) -->
        <script src="vendor/iro-5.3.1.min.js" inline></script>
        <!-- endRemoveIf(!light) -->
    </head>

    <body>

        <div id="error-notification" class="pure-g content">
        </div>

        <div id="password" class="webmode">

            <div class="content">

                <form id="form-setup-password" class="pure-form" autocomplete="off">

                    <div class="panel block" id="panel-password">

                        <div class="header">
                            <h1>SECURITY</h1>
                            <h2>Before using this device you have to change the default password for the user <strong>admin</strong>. This password will be used for the <strong>AP mode hotspot</strong>, the <strong>web interface</strong> (where you are now) and the <strong>over-the-air updates</strong>.</h2>
                        </div>

                        <div class="page">

                            <fieldset>
                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">New Password</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="adminPass0" data-settings-group-element="true" data-settings-real-name="adminPass" minlength="8" maxlength="63" type="password" autocomplete="false" spellcheck="false" required>
                                    <span class="no-select password-reveal"></span>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Repeat password</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="adminPass1" data-settings-group-element="true" data-settings-real-name="adminPass" minlength="8" maxlength="63" type="password" autocomplete="false" spellcheck="false" required>
                                    <span class="no-select password-reveal"></span>
                                </div>
                            </fieldset>

                            <div class="pure-g">
                                <div class="pure-u-1 pure-u-lg-1 hint">
                                    Password must be <strong>8..63 characters</strong> (numbers and letters and any of these special characters: _,.;:~!?@#$%^&amp;*&lt;&gt;\|(){}[]) and have at least <strong>one lowercase</strong> and <strong>one uppercase</strong> or <strong>one number</strong>.</div>
                            </div>


                            <div class="pure-g">
                                <button class="pure-u-11-24 pure-u-lg-1-4 pure-button button-generate-password" type="button" title="Generate password based on password policy">Generate</button>
                                <div class="pure-u-2-24 pure-u-lg-1-2"></div>
                                <button class="pure-u-11-24 pure-u-lg-1-4 pure-button button-setup-password" type="button" title="Save new password">Save</button>
                            </div>

                        </div>
                    </div>
                </form>

            </div> <!-- content -->

        </div>

        <div id="layout" class="webmode">
            <div class="menu-link">
                <span></span>
            </div>

            <div id="menu">
                <div class="pure-menu">

                    <span class="pure-menu-heading" data-key="hostname">HOSTNAME</span>
                    <span class="pure-menu-heading small" data-key="title">ESPurna 0.0.0</span>
                    <span class="pure-menu-heading small" data-key="desc"></span>

                    <ul class="pure-menu-list">

                        <li class="pure-menu-item">
                            <a href="#" class="pure-menu-link" data-panel="status">STATUS</a>
                        </li>

                        <li class="pure-menu-item menu-item-divided">
                            <a href="#" class="pure-menu-link" data-panel="general">GENERAL</a>
                        </li>

                        <!-- removeIf(!curtain) -->
                        <li class="pure-menu-item module module-curtain">
                            <a href="#" class="pure-menu-link" data-panel="curtain">CURTAIN</a>
                        </li>
                        <!-- endRemoveIf(!curtain) -->

                        <!-- removeIf(!garland) -->
                        <li class="pure-menu-item module module-garland">
                            <a href="#" class="pure-menu-link" data-panel="garland">GARLAND</a>
                        </li>
                        <!-- endRemoveIf(!garland) -->

                        <!-- removeIf(!thermostat) -->
                        <li class="pure-menu-item module module-thermostat">
                            <a href="#" class="pure-menu-link" data-panel="thermostat">THERMOSTAT</a>
                        </li>
                        <!-- endRemoveIf(!thermostat) -->

                        <!-- removeIf(!lightfox) -->
                        <li class="pure-menu-item module module-lightfox">
                            <a href="#" class="pure-menu-link" data-panel="lightfox">LIGHTFOX RF</a>
                        </li>
                        <!-- endRemoveIf(!lightfox) -->

                        <li class="pure-menu-item module module-dcz">
                            <a href="#" class="pure-menu-link" data-panel="domoticz">DOMOTICZ</a>
                        </li>

                        <li class="pure-menu-item module module-ha">
                            <a href="#" class="pure-menu-link" data-panel="ha">HASS</a>
                        </li>

                        <li class="pure-menu-item module module-idb">
                            <a href="#" class="pure-menu-link" data-panel="idb">INFLUXDB</a>
                        </li>

                        <li class="pure-menu-item module module-led">
                            <a href="#" class="pure-menu-link" data-panel="led">LED</a>
                        </li>

                        <!-- removeIf(!light) -->
                        <li class="pure-menu-item module module-color">
                            <a href="#" class="pure-menu-link" data-panel="color">LIGHTS</a>
                        </li>
                        <!-- endRemoveIf(!light) -->

                        <!-- removeIf(!rfm69) -->
                        <li class="pure-menu-item module module-rfm69">
                            <a href="#" class="pure-menu-link" data-panel="rfm69-mapping">MAPPING</a>
                        </li>

                        <li class="pure-menu-item module module-rfm69">
                            <a href="#" class="pure-menu-link" data-panel="rfm69-messages">MESSAGES</a>
                        </li>
                        <!-- endRemoveIf(!rfm69) -->

                        <li class="pure-menu-item module module-mqtt">
                            <a href="#" class="pure-menu-link" data-panel="mqtt">MQTT</a>
                        </li>

                        <li class="pure-menu-item module module-nofuss">
                            <a href="#" class="pure-menu-link" data-panel="nofuss">NOFUSS</a>
                        </li>

                        <li class="pure-menu-item module module-ntp">
                            <a href="#" class="pure-menu-link" data-panel="ntp">NTP</a>
                        </li>

                        <!-- removeIf(!rfbridge) -->
                        <li class="pure-menu-item module module-rfb">
                            <a href="#" class="pure-menu-link" data-panel="rfb">RF</a>
                        </li>
                        <!-- endRemoveIf(!rfbridge) -->

                        <li class="pure-menu-item module module-rpn">
                            <a href="#" class="pure-menu-link" data-panel="rpn">RULES</a>
                        </li>

                        <li class="pure-menu-item module module-sch">
                            <a href="#" class="pure-menu-link" data-panel="schedule">SCHEDULE</a>
                        </li>

                        <!-- removeIf(!sensor) -->
                        <li class="pure-menu-item module module-sns">
                            <a href="#" class="pure-menu-link" data-panel="sns">SENSORS</a>
                        </li>
                        <!-- endRemoveIf(!sensor) -->

                        <li class="pure-menu-item module module-relay">
                            <a href="#" class="pure-menu-link" data-panel="relay">SWITCHES</a>
                        </li>

                        <li class="pure-menu-item module module-tspk">
                            <a href="#" class="pure-menu-link" data-panel="thingspeak">THINGSPEAK</a>
                        </li>

                        <li class="pure-menu-item">
                            <a href="#" class="pure-menu-link" data-panel="wifi">WIFI</a>
                        </li>

                        <li class="pure-menu-item menu-item-divided">
                            <a href="#" class="pure-menu-link" data-panel="admin">ADMIN</a>
                        </li>

                        <li class="pure-menu-item module module-dbg">
                            <a href="#" class="pure-menu-link" data-panel="dbg">DEBUG</a>
                        </li>

                    </ul>

                    <div class="main-buttons">
                        <button type="button" class="pure-button button-update">Save</button>
                        <button type="button" class="pure-button button-reconnect">Reconnect</button>
                        <button type="button" class="pure-button button-reboot">Reboot</button>
                    </div>

                    <div class="footer">
                        &copy; 2016-2019<br>
                        Xose PÃ©rez<br>
                        <a class="external" href="https://twitter.com/xoseperez">@xoseperez</a><br>
                        <a class="external" href="https://tinkerman.cat">https://tinkerman.cat</a><br>
                        <a class="external" href="https://github.com/xoseperez/espurna">ESPurna at GitHub</a><br>
                        <a class="external" href="https://www.gnu.org/licenses/gpl-3.0.en.html">GPLv3 license</a><br>
                    </div>

                </div>
            </div>

            <div class="content">

                <div class="panel block" id="panel-status">

                    <div class="header">
                        <h1>STATUS</h1>
                        <h2>Current configuration</h2>
                    </div>

                    <div class="page">

                        <form class="pure-form pure-form-aligned">
                            <fieldset>

                                <div id="relays"></div>

                                <!-- removeIf(!light) -->
                                <div id="color"></div>
                                <div id="cct"></div>
                                <!-- endRemoveIf(!light) -->

                                <!-- removeIf(!light) -->
                                <div id="channels"></div>
                                <div id="light"></div>
                                <!-- endRemoveIf(!light) -->

                                <!-- removeIf(!sensor) -->
                                <div id="magnitudes"></div>
                                <!-- endRemoveIf(!sensor) -->

                                <!-- removeIf(!curtain) -->
                                <div id="curtains"></div>
                                <!-- endRemoveIf(!curtain) -->

                                <!-- removeIf(!rfm69) -->
                                <div class="pure-g module module-rfm69">
                                    <label class="pure-u-1 pure-u-lg-1-4">Packet count</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input class="pure-u-1" type="text" name="packetCount" readonly></div>
                                </div>

                                <div class="pure-g module module-rfm69">
                                    <label class="pure-u-1 pure-u-lg-1-4">Node count</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input class="pure-u-1" type="text" name="nodeCount" readonly></div>
                                </div>
                                <!-- endRemoveIf(!rfm69) -->

                                <div class="pure-u-1 pure-u-lg-1-2 state">

                                    <div class="pure-u-1-2">Manufacturer</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="manufacturer"></span></div>

                                    <div class="pure-u-1-2">Device</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="device"></span></div>

                                    <div class="pure-u-1-2">Chip ID</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="chipid"></span></div>

                                    <div class="pure-u-1-2">Wifi MAC</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="mac"></span></div>

                                    <div class="pure-u-1-2">SDK version</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="sdk"></span></div>

                                    <div class="pure-u-1-2">Core version</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="core"></span></div>

                                    <div class="pure-u-1-2">Firmware name</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="app_name"></span></div>

                                    <div class="pure-u-1-2">Firmware version</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="app_version"></span></div>

                                    <div class="pure-u-1-2">Firmware build date</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="app_build"></span></div>

                                    <div class="pure-u-1-2">Firmware size</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="sketch_size" post=" bytes"></span></div>

                                    <div class="pure-u-1-2">Free space</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="free_size" post=" bytes"></span></div>

                                </div>

                                <div class="pure-u-1 pure-u-lg-11-24 state">

                                    <div class="pure-u-1-2">Network</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="network"></span></div>

                                    <div class="pure-u-1-2">BSSID</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="bssid"></span></div>

                                    <div class="pure-u-1-2">Channel</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="channel"></span></div>

                                    <div class="pure-u-1-2">RSSI</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="rssi"></span></div>

                                    <div class="pure-u-1-2">IP</div>
                                    <div class="pure-u-11-24"><a href="" aria-label="device ip address"><span class="right" data-key="deviceip"></span></a> (<a href=""><span class="right">telnet</span></a>)</div>

                                    <div class="pure-u-1-2">Free heap</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="heap" post=" bytes"></span></div>

                                    <div class="pure-u-1-2">Load average</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="loadaverage"></span><span>%</span></div>

                                    <div class="pure-u-1-2">VCC</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="vcc">? </span><span>mV</span></div>

                                    <div class="pure-u-1-2 module module-mqtt">MQTT Status</div>
                                    <div class="pure-u-11-24 module module-mqtt"><span class="right" data-key="mqttStatus">UNKNOWN</span></div>

                                    <div class="pure-u-1-2 module module-ntp">NTP Status</div>
                                    <div class="pure-u-11-24 module module-ntp"><span class="right" data-key="ntpStatus">UNKNOWN</span></div>

                                    <div class="pure-u-1-2 module module-ntp">Current time</div>
                                    <div class="pure-u-11-24 module module-ntp"><span class="right" data-key="now"></span></div>

                                    <div class="pure-u-1-2">Uptime</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="uptime"></span></div>

                                    <div class="pure-u-1-2">Last update</div>
                                    <div class="pure-u-11-24"><span class="right" data-key="ago">?</span><span> seconds ago</span></div>

                                </div>

                            </fieldset>

                        </form>
                    </div>
                </div>

                <form id="form-general" class="pure-form form-settings">
                    <div class="panel" id="panel-general">

                        <div class="header">
                            <h1>GENERAL</h1>
                            <h2>General configuration values</h2>
                        </div>

                        <div class="page">

                            <fieldset>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Hostname</label>
                                    <input name="hostname" class="pure-u-1 pure-u-lg-1-4"  maxlength="32" type="text" data-action="reboot" pattern="^[A-za-z]([A-Za-z\d-]{1,30}[A-Za-z\d]|[A-Za-z\d]{0,31})$">
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        This name will identify this device in your network (http://&lt;hostname&gt;.local).<br>
                                        Hostname may contain only the ASCII letters 'a' through 'z' (in a case-insensitive manner), the digits '0' through '9', and the hyphen ('-'). They can neither start or end with an hyphen.<br>
                                        For this setting to take effect you should restart the wifi interface by clicking the "Reconnect" button.
                                    </div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Description</label>
                                    <input name="desc" class="pure-u-1 pure-u-lg-3-4"  maxlength="64" type="text">
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        Human-friendly name for your device. Will be reported with the heartbeat.<br>
                                        You can use this to specify the location or some other identification information.
                                    </div>
                                </div>

                                <div class="pure-g module module-btn">
                                    <label class="pure-u-1 pure-u-lg-1-4">Click repeat delay</label>
                                    <input name="btnRepDel" class="pure-u-1 pure-u-lg-1-4" type="number" data-action="reboot" min="0" step="100" max="1000">
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        Delay in milliseconds to detect a double or triple click (from 0 to 1000ms).<br>
                                        The lower this number the faster the device will respond to button clicks but the harder it will be to get the expected event.
                                        Increase this number if you are having trouble triggering the event.
                                        Set this value to 0 to disable repeat detection, device will respond immediately to a single button click. When using default configuration, consider that this will disable the SoftAP button action.<br>
                                        You will have to <strong>reboot the device</strong> to apply this setting.
                                    </div>
                                </div>

                                <div class="pure-g module module-alexa">
                                    <label class="pure-u-1 pure-u-lg-1-4">Alexa integration</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="alexaEnabled"></div>
                                </div>

                                <div class="pure-g module module-alexa">
                                    <label class="pure-u-1 pure-u-lg-1-4">Alexa device name</label>
                                    <input name="alexaName" class="pure-u-1 pure-u-lg-1-4"  maxlength="31" type="text" data-action="reboot">
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        This name will be used in Alexa integration.<br>
                                    </div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Heartbeat messages</label>
                                    <select class="pure-u-1 pure-u-lg-3-4" name="hbMode" >
                                        <option value="0">Disabled</option>
                                        <option value="1">Once per connection</option>
                                        <option value="2">Repeat after defined interval</option>
                                    </select>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Heartbeat interval</label>
                                    <input name="hbInterval" class="pure-u-1 pure-u-lg-1-4" type="number" min="1">
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        How often the heartbeat messages should be sent (number of <strong>seconds</strong>).
                                    </div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Heartbeat report</label>
                                    <select multiple class="pure-u-1 pure-u-lg-3-4" name="hbReport" >
                                        <option value="1">Device status</option>
                                        <option value="2">SSID</option>
                                        <option value="21">BSSID</option>
                                        <option value="3">IP</option>
                                        <option value="4">MAC</option>
                                        <option value="5">RSSI</option>
                                        <option value="6">Uptime</option>
                                        <option value="7">Datetime</option>
                                        <option value="8">Free heap</option>
                                        <option value="9">VCC</option>
                                        <option value="10">Relays status</option>
                                        <option value="11">Lights status</option>
                                        <option value="12">Hostname</option>
                                        <option value="13">App name</option>
                                        <option value="14">App version</option>
                                        <option value="15">Board</option>
                                        <option value="16">Loadavg</option>
                                        <option value="17">Heartbeat interval</option>
                                        <option value="18">Device description</option>
                                        <option value="19">Temperature range</option>
                                        <option value="20">Remote temperature</option>
                                    </select>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        Enable / disable heartbeat messages.
                                    </div>
                                </div>


                            </fieldset>

                        </div>
                    </div>
                </form>

                <form id="form-led" class="pure-form form-settings">
                    <div class="panel" id="panel-led">

                        <div class="header">
                            <h1>LED</h1>
                            <h2>Notification LED configuration</h2>
                        </div>

                        <div class="page">

                            <details>

                            <summary>Available modes</summary>
                            <ol class="pure-u-1 pure-u-lg-3-4 hint">
                                <li><strong>WiFi status</strong> will blink at 1Hz when trying to connect. If successfully connected it will briefly blink every 5 seconds if in STA mode or every second if in AP mode.</li>
                                <li><strong>Follow switch</strong> will force the LED to follow the status of a given switch (you must define which switch to follow in the side field).</li>
                                <li><strong>Inverse switch</strong> will force the LED to not-follow the status of a given switch (you must define which switch to follow in the side field).</li>
                                <li><strong>Find me</strong> will turn the LED ON when all switches are OFF. This is meant to locate switches at night.</li>
                                <li><strong>Find me &amp; WiFi</strong> will follow the WiFi status but will stay mostly on when switches are OFF, and mostly OFF when any of them is ON.</li>
                                <li><strong>Switches status</strong> will turn the LED ON whenever any switch is ON, and OFF otherwise. This is global status notification.</li>
                                <li><strong>Switches status &amp; WiFi</strong> will follow the WiFi status but will stay mostly off when switches are OFF, and mostly ON when any of them is ON.</li>
                                <li><strong>Manually managed</strong> will let you manage the LED status via MQTT by sending a message to "&lt;base_topic&gt;/led/0/set" with a payload of 0, 1 or 2 (to toggle it).</li>
                                <li><strong>Always ON</strong> and <strong>Always OFF</strong> modes are self-explanatory.</li>
                            </ol>

                            </details>

                            <fieldset>
                                <div id="leds" class="settings-group" data-settings-target="ledGpio"></div>
                                <button type="button" class="pure-button button-add-settings-group" data-settings-group="leds">Add LED</button>
                            </fieldset>
                        </div>
                    </div>
                </form>

                <form id="form-relay" class="pure-form form-settings">
                    <div class="panel" id="panel-relay">

                        <div class="header">
                            <h1>SWITCHES</h1>
                            <h2>Switch / relay configuration</h2>
                        </div>

                        <div class="page">

                            <fieldset>

                                <legend class="module module-multirelay">General</legend>

                                <div class="pure-g module module-multirelay">
                                    <label class="pure-u-1 pure-u-lg-1-4">Switch sync mode</label>
                                    <select name="relaySync" class="pure-u-1 pure-u-lg-3-4" >
                                        <option value="0">No synchronisation</option>
                                        <option value="1">Zero or one switches active</option>
                                        <option value="2">One and just one switch active</option>
                                        <option value="3">All synchronised</option>
                                        <option value="4">Switch #0 controls other switches</option>
                                    </select>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Define how the different switches should be synchronized.</div>
                                </div>

                                <div class="pure-g module module-multirelay">
                                    <label class="pure-u-1 pure-u-lg-1-4">Interlock delay</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input name="relayIlkDelay" class="pure-u-1" type="number" min="0"></div>
                                </div>

                                <div id="relayConfig" class="settings-group"></div>

                            </fieldset>

                        </div>
                    </div>
                </form>

                <!-- removeIf(!curtain) -->
                <form id="form-curtain" class="pure-form form-settings">
                    <div class="panel" id="panel-curtain">

                        <div class="header">
                            <h1>CURTAIN</h1>
                            <h2>Curtain configuration</h2>
                        </div>

                        <div class="page">

                            <fieldset>

                                <legend class="module module-curtain">General</legend>

                                <div class="pure-g module module-curtain">
                                    <label class="pure-u-1 pure-u-lg-1-4">Curtain type</label>
                                    <select class="pure-u-1 pure-u-lg-1-4" name="curtainType">
                                        <option value="0">Roller</option>
                                        <option value="1">Closing right</option>
                                        <option value="2">Closing left</option>
                                        <option value="3">Two sides</option>
                                    </select>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Define your curtain type. It adapts the graphical view in status menu.</div>
                                </div>

                                <div class="pure-g module module-curtain">
                                    <label class="pure-u-1 pure-u-lg-1-4">Curtain bootup position</label>
                                    <select class="pure-u-1 pure-u-lg-1-4" name="curtainBoot" >
                                        <option value="0">Do nothing</option>
                                        <option value="1">Closed</option>
                                        <option value="2">Opened</option>
                                        <option value="3">Last set position</option>
                                    </select>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Define the initial position of the curtain after a reboot or power loss.</div>
                                </div>

                                <div id="curtainConfig" class="settings-group"></div>

                            </fieldset>

                        </div>
                    </div>
                </form>
                <!-- endRemoveIf(!curtain) -->

                <!-- removeIf(!light) -->
                <form id="form-color" class="pure-form form-settings">
                    <div class="panel" id="panel-color">

                        <div class="header">
                            <h1>LIGHTS</h1>
                            <h2>Lights configuration</h2>
                        </div>

                        <div class="page">

                            <fieldset>

                                <div class="pure-g module-relay">
                                    <label class="pure-u-1 pure-u-lg-1-4">Light state switch</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="ltRelay"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">If enabled, add virtual relay switch that controls the ON / OFF state.</div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Save values</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="ltSave"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Save channel &amp; brightness values in settings</div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Save delay</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input class="pure-u-1" type="number" name="ltSaveDelay" min="5000" max="60000"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">When "Save values" is enabled, wait for the delay (ms) before the values are saved</div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Use color</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="useColor" data-action="reload"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Use the first three channels as RGB channels. This will also enable the color picker in the web UI. Will only work if the device has at least 3 dimmable channels.<br>Reload the page to update the web interface.</div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Use RGB picker</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="useRGB"  data-action="reload"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Use RGB color picker if enabled (plus brightness), otherwise use HSV (hue-saturation-value) style</div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Use white channel</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="useWhite" data-action="reload"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">For 2 channels warm white and cold white lights or color lights to use forth dimmable channel as (cold) white light calculated out of the RGB values.<br>Will only work if the device has at least 4 dimmable channels.<br>Enabling this will render useless the "Channel 4" slider in the status page.<br>Reload the page to update the web interface.</div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Use white color temperature</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="useCCT" data-action="reload"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Use a dimmable channel as warm white light and another dimmable channel as cold white light.<br>On devices with two dimmable channels the first use used for warm white light and the second for cold white light.<br>On color lights the fifth use used for warm white light and the fourth for cold white light.<br>Will only work if the device has exactly 2 dimmable channels or at least 5 dimmable channels and "white channel" above is also ON.<br>Enabling this will render useless the "Channel 5" slider in the status page.<br>Reload the page to update the web interface.</div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Use gamma correction</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="useGamma"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Use gamma correction for RGB channels.<br>Will only work if "use colorpicker" above is also ON.</div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Channel transitions</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="useTransitions"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">If enabled, channel changes will be smoothed.</div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Transition time</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input class="pure-u-1" type="number" name="ltTime" min="10" max="5000" data-action="reload"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Time to transition from one color to another (ms)</div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Transition step</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input class="pure-u-1" type="number" name="ltStep" min="10" max="5000" data-action="reload"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">(ms, depends on the transition time)</div>
                                </div>

                                <div class="pure-g">
                                    <div class="pure-u-1 pure-u-lg-1-4"><label>MQTT group</label></div>
                                    <div class="pure-u-1 pure-u-lg-3-4"><input class="pure-u-1" type="text" name="mqttGroupColor" data-action="reconnect"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Sync color between different lights.</div>
                                </div>

                            </fieldset>
                        </div>
                    </div>
                </form>
                <!-- endRemoveIf(!light) -->

                <form id="form-admin" class="pure-form form-settings">
                    <div class="panel" id="panel-admin">

                        <div class="header">
                            <h1>ADMINISTRATION</h1>
                            <h2>Device administration and security settings</h2>
                        </div>

                        <div class="page">

                            <fieldset>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Settings</label>
                                    <div class="pure-u-1-3 pure-u-lg-1-4"><button type="button" class="pure-button button-settings-backup pure-u-23-24">Backup</button></div>
                                    <div class="pure-u-1-3 pure-u-lg-1-4"><button type="button" class="pure-button button-settings-restore pure-u-23-24">Restore</button></div>
                                    <div class="pure-u-1-3 pure-u-lg-1-4"><button type="button" class="pure-button button-settings-factory pure-u-1">Factory Reset</button></div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Admin password</label>
                                    <input name="adminPass0" class="pure-u-1 pure-u-lg-3-4" placeholder="New password" data-settings-group-element="true" data-settings-real-name="adminPass" minlength="8" maxlength="63" type="password" data-action="reboot" autocomplete="false" spellcheck="false">
                                    <span class="no-select password-reveal"></span>
                                    <div class="pure-u-1 pure-u-lg-1-4"></div>
                                    <input name="adminPass1" class="pure-u-1 pure-u-lg-3-4" placeholder="Repeat password" data-settings-group-element="true" data-settings-real-name="adminPass" minlength="8" maxlength="63" type="password" data-action="reboot" autocomplete="false" spellcheck="false">
                                    <span class="no-select password-reveal"></span>

                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        The administrator password is used to access this web interface (user 'admin'), but also to connect to the device when in AP mode or to flash a new firmware over-the-air (OTA).<br>
                                        It must be <strong>8..63 characters</strong> (numbers and letters and any of these special characters: _,.;:~!?@#$%^&amp;*&lt;&gt;\|(){}[]) and have at least <strong>one lowercase</strong> and <strong>one uppercase</strong> or <strong>one number</strong>.</div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">HTTP port</label>
                                    <input name="webPort" class="pure-u-1 pure-u-lg-1-4" type="text" data-action="reboot">
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        This is the port for the web interface and API requests.
                                        If different than 80 (standard HTTP port) you will have to add it explicitly to your requests: http://myip:myport/
                                    </div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Enable WS Auth</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="wsAuth"></div>
                                </div>

                                <div class="pure-g module module-api">
                                    <label class="pure-u-1 pure-u-lg-1-4">Enable HTTP API</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="apiEnabled"></div>
                                </div>

                                <div class="pure-g module module-api">
                                    <label class="pure-u-1 pure-u-lg-1-4">Restful API</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="apiRestFul"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        If enabled, API requests to change a status (like a relay) must be done using PUT.
                                        If disabled you can issue them as GET requests (easier from a browser).
                                    </div>
                                </div>

                                <div class="pure-g module module-api">
                                    <label class="pure-u-1 pure-u-lg-1-4">HTTP API Key</label>
                                    <input name="apiKey" class="pure-u-3-4 pure-u-lg-1-2" type="text">
                                    <div class="pure-u-1-4 pure-u-lg-1-4"><button type="button" class="pure-button button-apikey pure-u-23-24">Auto</button></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        This is the key you will have to pass with every HTTP request to the API, either to get or write values.
                                        All API calls must contain the <strong>apikey</strong> parameter with the value above.
                                        To know what APIs are enabled do a call to <strong>/apis</strong>.
                                    </div>
                                </div>

                                <div class="pure-g module module-telnet">
                                    <label class="pure-u-1 pure-u-lg-1-4">Enable TELNET</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="telnetSTA"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Turn ON to be able to telnet to your device while connected to your home router.<br>TELNET is always enabled in AP mode.</div>
                                </div>

                                <div class="pure-g module module-telnet">
                                    <label class="pure-u-1 pure-u-lg-1-4">TELNET Password</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="telnetAuth"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Request password when starting telnet session</div>
                                </div>

                                <div class="pure-g module module-ota">
                                    <label class="pure-u-1 pure-u-lg-1-4">Upgrade</label>
                                    <input class="pure-u-1-2 pure-u-lg-1-2" name="filename" type="text" readonly>
                                    <div class="pure-u-1-4 pure-u-lg-1-8"><button type="button" class="pure-button button-upgrade-browse pure-u-23-24">Browse</button></div>
                                    <div class="pure-u-1-4 pure-u-lg-1-8"><button type="button" class="pure-button button-upgrade pure-u-23-24">Upgrade</button></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">The device has <span data-key="free_size"></span> bytes available for OTA updates. If your image is larger than this consider doing a <a class="external" href="https://github.com/xoseperez/espurna/wiki/TwoStepUpdates"><strong>two-step update</strong></a>.</div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4"><progress id="upgrade-progress" value="0" max="100"></progress></div>
                                    <input name="upgrade" type="file">
                                </div>

                            </fieldset>
                        </div>
                    </div>
                </form>

                <form id="form-wifi" class="pure-form form-settings">
                    <div class="panel" id="panel-wifi">

                        <div class="header">
                            <h1>WIFI</h1>
                            <h2>You can configure up to 5 different WiFi networks. The device will try to connect in order of signal strength.</h2>
                        </div>

                        <div class="page">

                            <fieldset>
                                <legend>Fallback SoftAP</legend>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">SSID</label>
                                    <input name="wifiApSsid" class="pure-u-1 pure-u-lg-1-4"  maxlength="32" type="text" data-action="reboot" >
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Passphrase</label>
                                    <input name="wifiApPass" class="pure-u-1 pure-u-lg-1-4"  maxlength="32" type="text" data-action="reboot" >
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        When specified, ESPurna will use these values in place of the hostname (see <strong>GENERAL</strong> panel) as SSID and device password (see <strong>ADMIN</strong> panel) as passphrase.
                                    </div>
                                </div>
                            </fieldset>

                            <fieldset>
                                <legend>Scanning</legend>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Enabled</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="wifiScan"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        ESPurna will scan for visible WiFi SSIDs and try to connect to networks defined below in order of <strong>signal strength</strong>, even if multiple AP share the same SSID.
                                        When disabled, ESPurna will try to connect to the networks in the same order they are listed below.
                                        Disable this option if you are <strong>connecting to a single access point</strong> (or router) or to a <strong>hidden SSID</strong>.
                                    </div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">RSSI threshold</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="number" name="wifiScanRssi" min="-128" max="0"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        When scanning is enabled, also periodically scan available networks when currently connected network RSSI is below this value.
                                    </div>
                                </div>

                                <div class="pure-g">
                                    <div class="pure-u-1 pure-u-lg-3-4"></div>
                                    <button class="pure-u-1 pure-u-lg-1-4 pure-button button-wifi-scan" type="button">
                                        See available networks
                                    </button>

                                    <div class="pure-u-0 pure-u-lg-1-4 scan loading">
                                        <img src="images/loading.gif" alt="Scanning" inline>
                                    </div>

                                    <table class="pure-u-1 pure-u-lg-1 pure-table" id="scanResult">
                                        <thead>
                                            <tr>
                                                <th scope="col">BSSID</th>
                                                <th scope="col">AUTH</th>
                                                <th scope="col">RSSI</th>
                                                <th scope="col">Channel</th>
                                                <th scope="col">SSID</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </fieldset>

                            <fieldset>
                                <legend>Networks</legend>
                                <div id="networks" class="settings-group" data-settings-target="ssid pass">
                                </div>
                                <button type="button" class="pure-button button-add-settings-group" data-settings-group="networks">Add network</button>
                            </fieldset>

                        </div>
                    </div>
                </form>

                <form id="form-schedule" class="pure-form form-settings">
                    <div class="panel" id="panel-schedule">
                        <div class="header">
                            <h1>SCHEDULE</h1>
                            <h2>Turn switches ON and OFF based on the current time.</h2>
                        </div>

                        <div class="page">
                            <fieldset>
                                <legend>Schedules</legend>
                                <div id="schedules" class="settings-group" data-settings-target="schTarget schType" ></div>
                            </fieldset>

                            <fieldset>
                                <legend>Add schedule</legend>
                                <button type="button" class="pure-button button-add-settings-group module module-relay" data-settings-group="schedules" data-settings-group-detail-target="switch">Switch</button>
                                <!-- removeIf(!light) -->
                                <button type="button" class="pure-button button-add-settings-group module module-color" data-settings-group="schedules" data-settings-group-detail-target="light">Light</button>
                                <!-- endRemoveIf(!light) -->
                                <!-- removeIf(!curtain) -->
                                <button type="button" class="pure-button button-add-settings-group module module-curtain" data-settings-group="schedules" data-settings-group-detail-target="curtain">Curtain</button>
                                <!-- endRemoveIf(!curtain) -->
                            </fieldset>
                        </div>
                    </div>
                </form>

                <!-- removeIf(!rfm69) -->
                <form id="form-rfm69-mapping" class="pure-form form-settings">
                    <div class="panel" id="panel-rfm69-mapping">

                        <div class="header">
                            <h1>MAPPING</h1>
                            <h2>
                                Configure the map between nodeID/key and MQTT topic. Messages from the given nodeID with the given key will be forwarded to the specified topic.
                                You can also configure a default topic using {nodeid} and {key} as placeholders, if the default topic is empty messages without defined map will be discarded.
                            </h2>
                        </div>

                        <div class="page">
                            <fieldset>
                                <legend>Default topic</legend>

                                <div class="pure-g">
                                    <input name="rfm69Topic" type="text" class="pure-u-23-24" value="" size="8" placeholder="Default MQTT Topic (use {nodeid} and {key} as placeholders)">
                                </div>
                            </fieldset>

                            <fieldset>
                                <legend>Specific topics</legend>
                                <div id="rfm69-mapping" class="settings-group">
                                </div>
                                <button type="button" class="pure-button button-add-settings-group" data-settings-group="rfm69-mapping">Add</button>
                            </fieldset>
                        </div>

                    </div>
                </form>

                <form id="form-rfm69-messages" class="pure-form">
                    <div class="panel" id="panel-rfm69-messages">
                        <div class="header">
                            <h1>MESSAGES</h1>
                            <h2>
                                Messages being received. Previous messages are not displayed.
                                You have to keep the page open in order to keep receiving them.
                                You can filter/unfilter by clicking on the values.
                                Left click on a value to show only rows that match that value, middle click to show all rows but those matching that value.
                                Filtered colums have red headers.
                            </h2>
                        </div>

                        <div class="page">
                            <table id="rfm69-messages" class="pure-table">
                                <thead>
                                    <tr>
                                        <th scope="col">Timestamp</th>
                                        <th scope="col">PacketID</th>
                                        <th scope="col">SenderID</th>
                                        <th scope="col">TargetID</th>
                                        <th scope="col">Key</th>
                                        <th scope="col">Value</th>
                                        <th scope="col">RSSI</th>
                                        <th scope="col">Duplicates</th>
                                        <th scope="col">Missing</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                            <div class="pure-g">
                                <button type="button" class="pure-button button-clear-filters">Clear filters</button>
                                <button type="button" class="pure-button button-clear-messages">Clear messages</button>
                                <button type="button" class="pure-button button-clear-counts">Clear counts</button>
                            </div>
                        </div>
                    </div>
                </form>
                <!-- endRemoveIf(!rfm69) -->

                <form id="form-mqtt" class="pure-form form-settings">
                    <div class="panel" id="panel-mqtt">

                        <div class="header">
                            <h1>MQTT</h1>
                            <h2>Configure an <strong>MQTT broker</strong> in your network and you will be able to change the switch status via an MQTT message.</h2>
                        </div>

                        <div class="page">

                            <fieldset>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Enable MQTT</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="mqttEnabled"></div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">MQTT Broker</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" name="mqttServer" type="text" placeholder="IP or address of your broker">
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">MQTT Port</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" name="mqttPort" type="text" value="1883">
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">MQTT User</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" name="mqttUser" type="text" placeholder="Leave blank if no user" autocomplete="off">
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        You can use the following placeholders: {hostname}, {mac}
                                    </div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">MQTT Password</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" name="mqttPassword" type="password" placeholder="Leave blank if no pass" autocomplete="new-password" spellcheck="false">
                                    <span class="no-select password-reveal"></span>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">MQTT Client ID</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" name="mqttClientID" type="text">
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        If left empty the firmware will generate a client ID based on the serial number of the chip. You can use the following placeholders: {hostname}, {mac}
                                    </div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">MQTT QoS</label>
                                    <select class="pure-u-1 pure-u-lg-1-4" name="mqttQoS">
                                        <option value="0">0: At most once</option>
                                        <option value="1">1: At least once</option>
                                        <option value="2">2: Exactly once</option>
                                    </select>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">MQTT Retain</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="mqttRetain"></div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">MQTT Keep Alive</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" type="number" name="mqttKeep" min="10" max="3600">
                                </div>

                                <div class="pure-g module module-mqttssl">
                                    <label class="pure-u-1 pure-u-lg-1-4">Use secure connection (SSL)</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="mqttUseSSL"></div>
                                </div>

                                <div class="pure-g module module-mqttssl">
                                    <label class="pure-u-1 pure-u-lg-1-4">SSL Fingerprint</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="mqttFP" type="text" maxlength="59">
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        This is the fingerprint for the SSL certificate of the server.<br>
                                        You can get it using <a class="external" href="https://www.grc.com/fingerprints.htm">https://www.grc.com/fingerprints.htm</a> (if it is publically available)<br>
                                        or, using <a class="external" href="https://www.openssl.org/">openssl</a>. For example, on a Linux / macOS machine:<br>
                                        <pre>$ echo -n | openssl s_client -connect &lt;host&gt;:&lt;port&gt; 2&gt;&and;1 | openssl x509 -noout -fingerprint -sha1 | cut -d\= -f2</pre>
                                    </div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">MQTT Root Topic</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="mqttTopic" type="text">
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        This is the root topic for this device. The {hostname} and {mac} placeholders will be replaced by the device hostname and MAC address.<br>
                                        - <strong>&lt;root&gt;/relay/#/set</strong> Send a 0 or a 1 as a payload to this topic to switch it on or off. You can also send a 2 to toggle its current state. Replace # with the switch ID (starting from 0). If the board has only one switch it will be 0.<br>
                                        <!-- removeIf(!curtain) -->
                                        - <strong>&lt;root&gt;/curtain/set</strong> Set the curtain opening value (0-100), 0 means closed, 100 opened. "on", "off", "pause" pilots buttons.<br>
                                        <!-- endRemoveIf(!curtain) -->
                                        <!-- removeIf(!light) -->
                                        <span class="module module-color">- <strong>&lt;root&gt;/rgb/set</strong> Set the color using this topic, your can either send an "#RRGGBB" value or "RRR,GGG,BBB" (0-255 each).<br></span>
                                        <span class="module module-color">- <strong>&lt;root&gt;/hsv/set</strong> Set the color using hue (0-360), saturation (0-100) and value (0-100) values, comma separated.<br></span>
                                        <span class="module module-color">- <strong>&lt;root&gt;/brightness/set</strong> Set the brighness (0-255).<br></span>
                                        <span class="module module-color">- <strong>&lt;root&gt;/channel/#/set</strong> Set the value for a single color channel (0-255). Replace # with the channel ID (starting from 0 and up to 4 for RGBWC lights).<br></span>
                                        <span class="module module-color">- <strong>&lt;root&gt;/mired/set</strong> Set the temperature color in mired.<br></span>
                                        <!-- endRemoveIf(!light) -->
                                        - <strong>&lt;root&gt;/status</strong> The device will report a 1 to this topic every few minutes. Upon MQTT disconnecting this will be set to 0.<br>
                                        - Other values reported (depending on the build) are: <strong>firmware</strong> and <strong>version</strong>, <strong>hostname</strong>, <strong>IP</strong>, <strong>MAC</strong>, signal strenth (<strong>RSSI</strong>), <strong>uptime</strong> (in seconds), <strong>free heap</strong> and <strong>power supply</strong>.
                                    </div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Use JSON payload</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="mqttUseJson"></div>
                                    <div class="pure-u-1 pure-u-lg-1-2"></div>
                                    <div class="pure-u-1 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        All messages (except the device status) will be included in a JSON payload along with the timestamp and hostname
                                        and sent under the <strong>&lt;root&gt;/data</strong> topic.<br>
                                        Messages will be queued and sent after 100ms, so different messages could be merged into a single payload.<br>
                                        Subscriptions will still be done to single topics.
                                    </div>
                                </div>

                            </fieldset>
                        </div>

                    </div>
                </form>

                <form id="form-nofuss" class="pure-form form-settings">
                    <div class="panel" id="panel-nofuss">

                        <div class="header">
                            <h1>NoFUSS</h1>
                            <h2>Automatically upgrade the firmware (see <a class="external" href="https://bitbucket.org/xoseperez/nofuss">xoseperez/nofuss</a> for details)</h2>
                        </div>

                        <div class="page">
                            <fieldset>
                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Enable</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="nofussEnabled"></div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Server</label>
                                    <input name="nofussServer" class="pure-u-1 pure-u-lg-3-4" type="text">
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Address of the NoFUSS server</div>
                                </div>
                            </fieldset>
                        </div>

                    </div>
                </form>

                <form id="form-ntp" class="pure-form form-settings">
                    <div class="panel" id="panel-ntp">

                        <div class="header">
                            <h1>NTP</h1>
                            <h2>Synchronize the device time with the remote server</h2>
                        </div>

                        <div class="page">

                            <fieldset>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Device Time</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="nowString" type="text" readonly>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Device Local Time</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="nowLocalString" type="text" readonly>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">NTP Server</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="ntpServer" type="text">
                                </div>

                                <div class="pure-g module module-ntp">
                                    <label class="pure-u-1 pure-u-lg-1-4">Time Zone</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="ntpTZ" type="text">
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">POSIX TZ variable, defaults to <code>UTC0</code><br>For the list of possible values, <a class="external" href="https://github.com/esp8266/Arduino/blob/master/cores/esp8266/TZ.h">see esp8266/Arduino's TZ.h (use the value inside of quotes))</a>. For the complete documentation, <a class="external" href="https://www.gnu.org/software/libc/manual/html_node/TZ-Variable.html">see libc tzset(3) manual page</a></div>
                                </div>

                            </fieldset>
                        </div>

                    </div>
                </form>

                <!-- removeIf(!garland) -->
                <form id="form-garland" class="pure-form form-settings">
                    <div class="panel" id="panel-garland">

                        <div class="header">
                            <h1>GARLAND</h1>
                            <h2>Garland configuration</h2>
                        </div>

                        <div class="page">

                            <div class="pure-g">
                                <label class="pure-u-1 pure-u-lg-1-4">Enable Garland</label>
                                <div class="pure-u-1 pure-u-lg-1-4"><input class="checkbox-garland-enable" type="checkbox" name="garlandEnabled"></div>
                            </div>

                            <div class="pure-g">
                                <label class="pure-u-1 pure-u-lg-1-4">Brightness</label>
                                <input class="pure-u-1 pure-u-lg-3-4 slider slider-garland-brightness" type="range" min="12" max="254" step="22" name="garlandBrightness">
                            </div>

                            <div class="pure-g">
                                <label class="pure-u-1 pure-u-lg-1-4">Speed</label>
                                <input class="pure-u-1 pure-u-lg-3-4 slider slider-garland-speed" type="range" min="10" max="70" name="garlandSpeed">
                            </div>

                            <button type="button" class="pure-button button-garland-set-default">Set default</button>

                        </div>
                    </div>
                </form>
                <!-- endRemoveIf(!garland) -->

                <!-- removeIf(!thermostat) -->
                <form id="form-thermostat" class="pure-form form-settings">
                    <div class="panel" id="panel-thermostat">

                        <div class="header">
                            <h1>THERMOSTAT</h1>
                            <h2>Thermostat configuration</h2>
                        </div>

                        <div class="page">

                            <div class="pure-g">
                                <label class="pure-u-1 pure-u-lg-1-4">Enable Thermostat</label>
                                <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="thermostatEnabled"></div>
                            </div>

                            <div class="pure-g">
                                <label class="pure-u-1 pure-u-lg-1-4">Thermostat Mode</label>
                                <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="thermostatMode"></div>
                            </div>

                            <div class="pure-g">
                                <label class="pure-u-1 pure-u-lg-1-4" for="thermostatOperationMode">Operation mode</label>
                                <input class="pure-u-1 pure-u-lg-1-4" name="thermostatOperationMode" type="text" readonly>
                            </div>

                            <fieldset>

                                <legend>Temperature range</legend>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Max (<span data-key="thermostatTmpUnits"></span>)</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" id="tempRangeMaxInput" name="tempRangeMax" type="number" min="1" max="100" data="20">
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Min (<span data-key="thermostatTmpUnits"></span>)</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" id="tempRangeMinInput" name="tempRangeMin" type="number" min="0" max="99" data="10">
                                </div>

                            </fieldset>

                            <fieldset>

                                <legend>Remote sensor</legend>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4" for="remoteSensorName">Remote sensor name</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" name="remoteSensorName" type="text">
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4" for="remoteTmp">Remote temperature (<span data-key="thermostatUnit"></span>)</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" name="remoteTmp" type="text" readonly>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4" for="remoteTempMaxWait">Remote temperature waiting (s)</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" name="remoteTempMaxWait" type="number" min="0" max="1800" data="120">
                                </div>

                            </fieldset>

                            <fieldset>

                                <legend>Operation mode</legend>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4" for="maxOnTime">Max heating time (m)</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" name="maxOnTime" type="number" min="0" max="180" data="30">
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4" for="minOffTime">Min rest time (m)</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" name="minOffTime" type="number" min="0" max="60" data="10">
                                </div>

                            </fieldset>

                            <fieldset>

                                <legend>Autonomous mode</legend>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4" for="aloneOnTime">Heating time (m)</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" name="aloneOnTime" type="number" min="0" max="180" data="5">
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4" for="aloneOffTime">Rest time (m)</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" name="aloneOffTime" type="number" min="0" max="180" data="55">
                                </div>

                            </fieldset>

                            <fieldset>

                                <legend>Time worked</legend>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4" for="burnToday">Today</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" type="text" name="burnToday" readonly>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4" for="burnYesterday">Yesterday</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" type="text" name="burnYesterday" readonly>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4" for="burnThisMonth">Current month</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" type="text" name="burnThisMonth" readonly>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4" for="burnPrevMonth">Previous month</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" type="text" name="burnPrevMonth" readonly>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4" for="burnTotal">Total</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" type="text" name="burnTotal" readonly>
                                </div>

                                <div class="pure-g">
                                    <button type="button" class="pure-button button-thermostat-reset-counters">Reset counters</button>
                                </div>

                            </fieldset>
                        </div>
                    </div>
                </form>
                <!-- endRemoveIf(!thermostat) -->

                <form id="form-domoticz" class="pure-form form-settings">
                    <div class="panel" id="panel-domoticz">

                        <div class="header">
                            <h1>DOMOTICZ</h1>
                            <h2>
                                Configure the connection to your Domoticz server.
                            </h2>
                        </div>

                        <div class="page">

                            <fieldset>
                                <legend>General</legend>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Enable Domoticz</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="dczEnabled"></div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Domoticz IN Topic</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="dczTopicIn" type="text">
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Domoticz OUT Topic</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="dczTopicOut" type="text" data-action="reconnect">
                                </div>
                            </fieldset>

                            <!-- removeIf(!light) -->
                            <fieldset class="module module-color">
                                <legend>Lights (IN messages only)</legend>
                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Light switch</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input class="pure-u-1 pure-u-lg-23-24" name="dczLightIdx" type="number" min="0"></div>
                                </div>
                            </fieldset>
                            <!-- endRemoveIf(!light) -->

                            <fieldset>
                                <legend>Sensors &amp; actuators</legend>

                                <div class="pure-g">
                                    <div class="pure-u-1 hint">Set IDX to 0 to disable notifications from that component.</div>
                                </div>

                                <div id="dczRelays" class="settings-group"></div>

                                <!-- removeIf(!sensor) -->
                                <div id="dczMagnitudes" class="settings-group"></div>
                                <!-- endRemoveIf(!sensor) -->
                            </fieldset>
                        </div>

                    </div>
                </form>

                <form id="form-ha" class="pure-form form-settings">
                    <div class="panel" id="panel-ha">

                        <div class="header">
                            <h1>HOME ASSISTANT</h1>
                            <h2>
                                Add this device to your Home Assistant.
                            </h2>
                        </div>

                        <div class="page">
                            <fieldset>

                                <legend><a class="external" href="https://www.home-assistant.io/docs/mqtt/discovery/">Discovery</a></legend>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Enabled</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="haEnabled"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        Home Assistant MQTT discovery. Enable / disable, then save to trigger the update.
                                    </div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Prefix</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" name="haPrefix" type="text">
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        The prefix for the discovery topic e.g. <code><strong>&lt;prefix&gt;</strong>/switch/espurna-123456/config</code>
                                    </div>
                                </div>
                            </fieldset>

                            <fieldset>
                                <legend>MQTT</legend>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Retain</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="haRetain"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        Set the <strong>Retain</strong> flag when sending the messages.
                                    </div>
                                </div>
                            </fieldset>
                        </div>

                    </div>
                </form>

                <form id="form-thingspeak" class="pure-form form-settings">
                    <div class="panel" id="panel-thingspeak">

                        <div class="header">
                            <h1>THINGSPEAK</h1>
                            <h2>
                                Send your sensors data to Thingspeak.
                            </h2>
                        </div>

                        <div class="page">

                            <fieldset>

                                <legend>General</legend>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Enable Thingspeak</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="tspkEnabled"></div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Clear cache</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="tspkClear"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        With every POST to thinkspeak.com only enqueued fields are sent.
                                        If you select to clear the cache after every sending this will result in only those fields that have changed will be posted.
                                        If you want all fields to be sent with every POST do not clear the cache.
                                    </div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Thingspeak address</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="tspkAddress" type="text">
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Thingspeak API Key</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="tspkKey" type="text">
                                </div>
                            </fieldset>

                            <fieldset>
                                <legend>Sensors &amp; actuators</legend>

                                <div class="pure-g">
                                    <div class="pure-u-1 hint">Enter the field number to send each data to, 0 disable notifications from that component.</div>
                                </div>

                                <div id="tspkRelays" class="settings-group"></div>

                                <!-- removeIf(!sensor) -->
                                <div id="tspkMagnitudes" class="settings-group"></div>
                                <!-- endRemoveIf(!sensor) -->
                            </fieldset>
                        </div>

                    </div>
                </form>

                <form id="form-idb" class="pure-form form-settings">
                    <div class="panel" id="panel-idb">

                        <div class="header">
                            <h1>INFLUXDB</h1>
                            <h2>
                                Configure the connection to your InfluxDB server. Leave the host field empty to disable InfluxDB connection.
                            </h2>
                        </div>

                        <div class="page">

                            <fieldset>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Enable InfluxDB</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="idbEnabled"></div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Host</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="idbHost" type="text">
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Port</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="idbPort" type="text">
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Database</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="idbDatabase" type="text">
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Username</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="idbUsername" type="text" autocomplete="off">
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Password</label>
                                    <input class="pure-u-1 pure-u-lg-3-4" name="idbPassword" type="password" autocomplete="new-password" spellcheck="false">
                                    <span class="no-select password-reveal"></span>
                                </div>

                            </fieldset>
                        </div>

                    </div>
                </form>

                <form id="form-rpn" class="pure-form form-settings">
                    <div class="panel" id="panel-rpn">

                        <div class="header">
                            <h1>RULES</h1>
                            <h2>
                                Here you can configure advanced rules based on RPN expressions. Check the <a class="external" href="https://github.com/xoseperez/espurna/wiki/RPN-Rules">wiki page about the RPN Rules module</a> to know how to use them.
                            </h2>
                        </div>

                        <div class="page">

                            <fieldset>

                                <legend>Configuration</legend>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Sticky variables</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input type="checkbox" name="rpnSticky"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">
                                        Sticky variables are persistent, once defined the first time they will be always available until next reboot (they do not persist across reboots).
                                        Non sticky variables are only available during the next rule execution, just after being defined, and then removed. This applies to status, sensor and MQTT variables equally.
                                        Mind that calling a non-existing variable from a rule will make it silently fail.
                                    </div>
                                </div>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4" for="rpnDelay">Execution delay (ms)</label>
                                    <input class="pure-u-1 pure-u-lg-1-4" name="rpnDelay" type="number" min="100">
                                </div>

                            </fieldset>

                            <fieldset>
                                <legend>Rules</legend>

                                <div id="rpn-rules" class="settings-group" data-settings-target="rpnRule" ></div>
                                <button type="button" class="pure-button button-add-settings-group" data-settings-group="rpn-rules">Add</button>
                            </fieldset>

                            <fieldset>
                                <legend>MQTT</legend>

                                <div class="pure-g">
                                    <div class="pure-u-1-2">Topic</div>
                                    <div class="pure-u-1-3">Variable Name</div>
                                </div>

                                <div id="rpn-topics" class="settings-group" data-settings-target="rpnTopic" ></div>
                                <button type="button" class="pure-button button-add-settings-group" data-settings-group="rpn-topics">Add</button>
                            </fieldset>
                        </div>

                    </div>
                </form>

                <form id="form-dbg" class="pure-form">
                    <div class="panel" id="panel-dbg">

                        <div class="header">
                            <h1>DEBUG LOG</h1>
                            <h2>
                                Shows debug messages from the device
                            </h2>
                        </div>

                        <div class="page">

                            <fieldset>

                                <div class="pure-g module module-cmd">
                                    <div class="pure-u-1 hint">
                                        Write a command and click send to execute it on the device. The output will be shown in the debug text area below.
                                        <!-- removeIf(!curtain) -->
                                        Type "debug" to display MCU serial exchanges. Any other command is sent to MCU serial as is.
                                        <!-- endRemoveIf(!curtain) -->
                                    </div>
                                    <input name="dbgcmd" class="pure-u-3-4" type="text" data-action="none">
                                    <div class="pure-u-1-4 pure-u-lg-1-4"><button type="submit" class="pure-button button-dbgcmd pure-u-23-24">Send</button></div>
                                </div>

                                <div class="pure-g">
                                    <textarea class="pure-u-1 terminal" id="weblog" name="weblog" wrap="soft" readonly></textarea>
                                    <div class="pure-u-1-4 pure-u-lg-1-4"><button type="button" class="pure-button button-dbg-clear pure-u-23-24">Clear</button></div>
                                </div>

                            </fieldset>

                        </div>

                    </div>
                </form>

                <!-- removeIf(!sensor) -->
                <form id="form-sns" class="pure-form form-settings">
                    <div class="panel" id="panel-emon-expected">
                        <div class="header">
                            <h1>Expected values</h1>
                            <h2>Calculate ratios from raw values that can be measured externally. <br>Enter the known values and press <strong>Calculate</strong> to see the resulting ratio values. Press <strong>Apply</strong> to update ratio values on the SENSORS panel. Press <strong>Save</strong> to commit the changes.</h2>
                        </div>

                        <fieldset>
                            <legend>Settings</legend>
                            <div class="pure-button-group" role="group">
                                <button type="button" class="pure-button button-emon-expected-calculate">Calculate</button>
                                <button type="button" class="pure-button button-emon-expected-apply">Apply</button>
                            </div>
                        </fieldset>

                        <fieldset>
                            <legend>Magnitudes</legend>
                            <div id="emon-expected" class="pure-form pure-form-aligned settings-group">
                            </div>
                        </fieldset>
                    </div>

                    <div class="panel" id="panel-sns">

                        <div class="header">
                            <h1>SENSOR CONFIGURATION</h1>
                            <h2>
                                Configure and calibrate your device sensors.
                            </h2>
                        </div>

                        <div class="page pure-form">

                            <fieldset>

                                <legend>General</legend>

                                <div class="pure-form-aligned">
                                    <div class="pure-u-1 pure-u-lg-1">
                                        <label>Read every</label>
                                        <input name="snsRead" type="number" min="1" list="list:snsRead" class="pure-u-1 pure-u-lg-1-4">
                                        <span> second(s)</span>
                                        <datalist id="list:snsRead">
                                            <option value="1"></option>
                                            <option value="6"></option>
                                            <option value="10"></option>
                                            <option value="15"></option>
                                            <option value="30"></option>
                                            <option value="60"></option>
                                            <option value="300"></option>
                                            <option value="600"></option>
                                            <option value="900"></option>
                                            <option value="1800"></option>
                                            <option value="3600"></option>
                                        </datalist>
                                        <span class="pure-form-message-inline">
                                            Time between the attempts to read from the sensor.
                                            Please mind some sensors do not have refresh values very often, check the sensor datasheet to know the minimum read interval.
                                            The default and recommended value is 6 seconds.
                                        </span>
                                    </div>

                                    <div class="pure-u-1 pure-u-lg-1">
                                        <label>Report aggregated value every</label>
                                        <input name="snsReport" type="number" min="1" step="1" max="60">
                                        <span> reading(s)</span>
                                    </div>

                                    <div class="pure-u-1 pure-u-lg-1 module module-emon">
                                        <label>Save aggregated value every</label>
                                        <input name="snsSave" type="number" min="0" step="1" max="200">
                                        <span> report(s)</span>
                                        <span class="pure-form-message-inline">
                                            At this moment, only applies to total energy readings.
                                            Set to 0 to disable.
                                            <br><strong>Note that this feature uses the internal flash. Repeatedly writing to the flash storage will quickly wear it out.</strong>
                                        </span>
                                    </div>

                                    <div class="pure-u-1 pure-u-lg-1">
                                        <label>Real time API</label>
                                        <div><input type="checkbox" name="snsRealTime"></div>
                                        <span class="pure-form-message-inline">
                                            Most magnitudes are being preprocessed and filtered to avoid spurious values.
                                            Enable this to get unfiltered values in the API (HTTP, MQTT, Prometheus, etc.)
                                        </span>
                                    </div>

                                </div>

                            </fieldset>

                            <fieldset class="module module-analog">
                                <legend>Analog sensor</legend>

                                <div class="pure-g module module-mics">
                                    <label class="pure-u-1 pure-u-lg-1-4">Calibrate</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><button type="button" name="analog-calibrate" class="pure-button button-reboot button-simple-action">Reboot</button></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Reset gas sensor calibration. Check the sensor datasheet for calibration conditions.</div>
                                </div>
                            </fieldset>

                            <fieldset class="module module-emon">
                                <legend>Ratios</legend>
                                <div id="emon-ratios" class="pure-form-aligned settings-group">
                                </div>

                                <div class="pure-g">
                                    <div class="pure-u-1 pure-u-lg-1-2"><button type="button" data-panel="emon-expected" class="pure-button button-emon-expected">Calculate ratios from expected values</button></div>
                                </div>
                            </fieldset>

                            <fieldset>
                                <legend>Units</legend>
                                <div id="magnitude-units" class="pure-form settings-group">
                                </div>
                            </fieldset>

                            <fieldset class="module module-emon">
                                <legend>Energy monitor</legend>

                                <div class="pure-g">
                                    <div class="pure-u-1 pure-u-lg-1-2"><button type="button" name="emon-reset-calibration" class="pure-button button-simple-action">Reset <strong>all</strong> internal calibration values</button></div>
                                </div>

                                <div class="pure-g">
                                    <div class="pure-u-1 pure-u-lg-1-2"><button type="button" name="emon-reset-energy" class="pure-button button-simple-action">Set the energy count of all sensors to zero</button></div>
                                </div>

                            </fieldset>

                        </div>

                    </div>
                </form>
                <!-- endRemoveIf(!sensor) -->

                <!-- removeIf(!rfbridge) -->
                <form id="form-rfb" class="pure-form form-settings">
                    <div class="panel" id="panel-rfb">

                        <div class="header">
                            <h1>RADIO FREQUENCY</h1>
                            <h2>
                                Sonoff 433 RF Bridge &amp; RF Link Configuration<br><br>
                                This page allows you to configure the RF codes for the Sonoff RFBridge 433 and also for a basic RF receiver.<br><br>
                                To learn a new code click <strong>LEARN</strong> (the Sonoff RFBridge will beep) then press a button on the remote, the new code should show up (and the RFBridge will double beep). If the device double beeps but the code does not update it has not been properly learnt. Keep trying.<br><br>
                                Modify or create new codes manually and then click <strong>SAVE</strong> to store them in the device memory. If your controlled device uses the same code to switch ON and OFF, learn the code with the ON button and copy paste it to the OFF input box, then click SAVE on the last one to store the value.<br><br>
                                Delete any code clicking the <strong>FORGET</strong> button.
                                <br><br>You can also specify any RAW code. For reference see <a class="external" href="https://github.com/Portisch/RF-Bridge-EFM8BB1/wiki/Commands">possible commands for Sonoff RF Bridge EFM8BB1</a> (original firmware supports codes from <strong>0xA0</strong> to <strong>0xA5</strong>).
                            </h2>
                        </div>

                        <div class="page">
                            <fieldset>
                                <legend>RF Codes</legend>
                                <div id="rfbNodes"></div>
                            </fieldset>

                            <fieldset>
                                <legend>Settings</legend>

                                <div class="pure-g">
                                    <label class="pure-u-1 pure-u-lg-1-4">Repeats</label>
                                    <div class="pure-u-1 pure-u-lg-1-4"><input class="pure-u-1 pure-u-lg-23-24" name="rfbRepeat" type="number" min="1"></div>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                    <div class="pure-u-0 pure-u-lg-1-4"></div>
                                    <div class="pure-u-1 pure-u-lg-3-4 hint">Number of times to repeat transmission</div>
                                </div>

                                <div class="pure-g module module-rfbdirect">
                                    <div class="pure-u-1 pure-u-lg-1 hint">Pins used by the receiver (RX) and transmitter (TX). Set to <strong>NONE</strong> to disable</div>

                                    <label class="pure-u-1 pure-u-lg-1-4">RX Pin</label>
                                    <select class="pure-u-1 pure-u-lg-1-4 enumerable enumerable-gpio-hardware" name="rfbRX"></select>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>

                                    <label class="pure-u-1 pure-u-lg-1-4">TX Pin</label>
                                    <select class="pure-u-1 pure-u-lg-1-4 enumerable enumerable-gpio-hardware" name="rfbTX"></select>
                                    <div class="pure-u-0 pure-u-lg-1-2"></div>
                                </div>
                            </fieldset>
                        </div>

                    </div>
                </form>
                <!-- endRemoveIf(!rfbridge) -->

                <!-- removeIf(!lightfox) -->
                <form id="form-lightfox" class="pure-form form-settings">
                    <div class="panel" id="panel-lightfox">

                        <div class="header">
                            <h1>LIGHTFOX RF</h1>
                            <h2>
                                LightFox RF configuration<br><br>
                                This page allows you to control LightFox RF receiver options.<br><br>
                                To learn a new code click <strong>LEARN</strong>, wait for 3 seconds then press a button on the remote, one of the relays will toggle. If no device relay toggles the code has not been properly learnt, keep trying!<br><br>
                                Delete all the codes by clicking the <strong>CLEAR</strong> button and wait for 10 seconds.<br><br>
                            </h2>
                        </div>

                        <div class="page">
                            <div class="pure-g">
                                <label class="pure-u-1 pure-u-lg-1-4">RF Actions</label>
                                <div class="pure-u-1-2 pure-u-lg-3-8"><button type="button" class="pure-button button-lightfox-learn pure-u-23-24">Learn</button></div>
                                <div class="pure-u-1-2 pure-u-lg-3-8"><button type="button" class="pure-button button-lightfox-clear pure-u-1">Clear</button></div>
                            </div>
                        </div>

                    </div>
                </form>
                <!-- endRemoveIf(!lightfox) -->

            </div> <!-- content -->

        </div> <!-- layout -->

        <!-- Templates -->

        <template id="template-led-config" >
            <div class="pure-form pure-form-aligned">
                <fieldset>
                    <legend class="pure-u-1 pure-u-lg-1-4">LED #<span></span></legend>
                    <div class="pure-control-group">
                        <label>GPIO</label>
                        <select class="pure-input-2-3 enumerable enumerable-gpio-hardware" name="ledGpio" data-action="reboot"></select>
                    </div>
                    <div class="pure-control-group">
                        <label>Mode</label>
                        <select class="pure-input-2-3" name="ledMode">
                            <option value="1">WiFi status</option>
                            <option value="2">Follow switch #</option>
                            <option value="3">Inverse switch #</option>
                            <option value="4">Find me</option>
                            <option value="5">Find me &amp; WiFi</option>
                            <option value="8">Switches status</option>
                            <option value="9">Switches &amp; WiFi</option>
                            <option value="0">Manual</option>
                            <option value="6">Always ON</option>
                            <option value="7">Always OFF</option>
                        </select>
                    </div>
                    <div class="module-relay pure-control-group">
                        <label>Relay ID</label>
                        <select class="pure-u-1 pure-u-lg-1-4 enumerable enumerable-relay" name="ledRelay" ></select>
                    </div>
                </fieldset>
            </div>
        </template>

        <!-- removeIf(!rfbridge) -->
        <template id="template-rfb-node" >
            <div class="pure-g">
                <fieldset>
                    <legend>Switch #<span></span></legend>
                    <div class="pure-u-1 pure-u-lg-1-1">
                        <label class="pure-u-1 pure-u-lg-1-4">Switch ON</label>
                        <input class="pure-u-1 pure-u-lg-1-3" type="text" maxlength="116" name="rfbcode" data-status="1" data-settings-ignore="true">
                        <div class="pure-u-1-3 pure-u-lg-1-8"><button type="button" class="pure-u-23-24 pure-button button-rfb-learn">LEARN</button></div>
                        <div class="pure-u-1-3 pure-u-lg-1-8"><button type="button" class="pure-u-23-24 pure-button button-rfb-send">SAVE</button></div>
                        <div class="pure-u-1-3 pure-u-lg-1-8"><button type="button" class="pure-u-23-24 pure-button button-rfb-forget">FORGET</button></div>
                    </div>
                    <div class="pure-u-1 pure-u-lg-1-1">
                        <div class="pure-u-1 pure-u-lg-1-4"><label>Switch OFF</label></div>
                        <input class="pure-u-1 pure-u-lg-1-3" type="text" maxlength="116" name="rfbcode" data-status="0" data-settings-ignore="true">
                        <div class="pure-u-1-3 pure-u-lg-1-8"><button type="button" class="pure-u-23-24 pure-button button-rfb-learn">LEARN</button></div>
                        <div class="pure-u-1-3 pure-u-lg-1-8"><button type="button" class="pure-u-23-24 pure-button button-rfb-send">SAVE</button></div>
                        <div class="pure-u-1-3 pure-u-lg-1-8"><button type="button" class="pure-u-23-24 pure-button button-rfb-forget">FORGET</button></div>
                    </div>
                </fieldset>
            </div>
        </template>
        <!-- endRemoveIf(!rfbridge) -->

        <template id="template-network-config">
            <div class="pure-g">
                <label class="pure-u-1 pure-u-lg-1-4">Network SSID</label>
                <div class="pure-u-5-6 pure-u-lg-2-3"><input name="ssid" type="text" class="pure-u-23-24" value="" data-action="reconnect" placeholder="Network SSID" required autocomplete="false"></div>
                <div class="pure-u-1-6 pure-u-lg-1-12"><button type="button" class="pure-button button-more-parent pure-u-1">...</button></div>

                <label class="pure-u-1 pure-u-lg-1-4 more">Password</label>
                <input class="pure-u-1 pure-u-lg-3-4 more" name="pass" type="password" value="" data-action="reconnect" autocomplete="new-password" spellcheck="false">
                <span class="no-select password-reveal more"></span>

                <label class="pure-u-1 pure-u-lg-1-4 more">Static IP</label>
                <input class="pure-u-1 pure-u-lg-3-4 more" name="ip" type="text" value="" data-action="reconnect" maxlength="15" autocomplete="false">
                <div class="pure-u-0 pure-u-lg-1-4 more"></div>
                <div class="pure-u-1 pure-u-lg-3-4 hint more">Leave empty for DHCP negotiation</div>

                <label class="pure-u-1 pure-u-lg-1-4 more">Gateway IP</label>
                <input class="pure-u-1 pure-u-lg-3-4 more" name="gw" type="text" value="" data-action="reconnect" maxlength="15" autocomplete="false">
                <div class="pure-u-0 pure-u-lg-1-4 more"></div>
                <div class="pure-u-1 pure-u-lg-3-4 hint more">Set when using a static IP</div>

                <label class="pure-u-1 pure-u-lg-1-4 more">Network Mask</label>
                <input class="pure-u-1 pure-u-lg-3-4 more" name="mask" type="text" value="" data-action="reconnect" maxlength="15" autocomplete="false">
                <div class="pure-u-0 pure-u-lg-1-4 more"></div>
                <div class="pure-u-1 pure-u-lg-3-4 hint more">Usually 255.255.255.0 for /24 networks</div>

                <label class="pure-u-1 pure-u-lg-1-4 more">DNS IP</label>
                <input class="pure-u-1 pure-u-lg-3-4 more" name="dns" type="text" value="" data-action="reconnect" maxlength="15" autocomplete="false">
                <div class="pure-u-0 pure-u-lg-1-4 more"></div>
                <div class="pure-u-1 pure-u-lg-3-4 hint more">Set the Domain Name Server IP to use when using a static IP</div>

                <div class="pure-u-0 pure-u-lg-1-4 more"></div>
                <button class="pure-button button-del-parent more" type="button">Delete network</button>
            </div>
        </template>

        <template id="template-schedule-config" >
            <div class="pure-g">
                <label class="pure-u-1 pure-u-lg-1-4">When time is</label>
                <div class="pure-u-1-4 pure-u-lg-1-5">
                    <input class="pure-u-2-3" name="schHour" type="number" min="0" step="1" max="23" value="0">
                    <div class="pure-u-1-4 hint center">&nbsp;h</div>
                </div>
                <div class="pure-u-1-4 pure-u-lg-1-5">
                    <input class="pure-u-2-3" name="schMinute" type="number" min="0" step="1" max="59" value="0">
                    <div class="pure-u-1-4 hint center">&nbsp;m</div>
                </div>
                <div class="pure-u-0 pure-u-lg-1-3"></div>

                <label class="pure-u-1 pure-u-lg-1-4">Use UTC time</label>
                <div class="pure-u-1 pure-u-lg-3-4"><input type="checkbox" name="schUTC"></div>

                <div class="pure-u-0 pure-u-lg-1-2"></div>
                <label class="pure-u-1 pure-u-lg-1-4">And weekday is one of</label>
                <div class="pure-u-2-5 pure-u-lg-1-5">
                    <input class="pure-u-23-24 pure-u-lg-23-24" name="schWDs" type="text" maxlength="15" value="1,2,3,4,5,6,7">
                </div>
                <div class="pure-u-3-5 pure-u-lg-1-2 hint center">&nbsp;1 for Monday, 2 for Tuesday etc., comma separated</div>

                <div class="schedule-action pure-u-1 pure-u-lg-1">
                </div>

                <label class="pure-u-1 pure-u-lg-1-4">Restore on boot</label>
                <div class="pure-u-1 pure-u-lg-3-4"><input type="checkbox" name="schRestore"></div>

                <div class="pure-u-0 pure-u-lg-1-2"></div>

                <label class="pure-u-1 pure-u-lg-1-4">Enabled</label>
                <div class="pure-u-1 pure-u-lg-3-4"><input type="checkbox" name="schEnabled"></div>

                <div class="pure-u-0 pure-u-lg-1-4"></div>
                <button class="pure-button button-del-parent" type="button">Delete schedule</button>
            </div>
        </template>

        <template id="template-schedule-action-relay">
            <label class="pure-u-1 pure-u-lg-1-4">Action</label>
            <div class="pure-u-1 pure-u-lg-1-5">
                <select class="pure-u-1 pure-u-lg-23-24" name="schAction" data-changed="true">

                    <option value="0">Turn OFF</option>
                    <option value="1">Turn ON</option>
                    <option value="2">Toggle</option>
                </select>
            </div>
            <select class="pure-u-1 pure-u-lg-1-4 enumerable enumerable-relay" name="schTarget" ></select>
            <input type="hidden" name="schType" value="1">
        </template>

        <!-- removeIf(!light) -->
        <template id="template-schedule-action-light">
            <label class="pure-u-1 pure-u-lg-1-4">Brightness</label>
            <div class="pure-u-1 pure-u-lg-1-5">
                <input class="pure-u-2-3" name="schAction" type="number" min="0" step="1" max="255" value="0">
            </div>
            <select class="pure-u-1 pure-u-lg-1-4 enumerable enumerable-channel" name="schTarget" ></select>
            <input type="hidden" name="schType" value="2">
        </template>
        <!-- endRemoveIf(!light) -->

        <!-- removeIf(!curtain) -->
        <template id="template-schedule-action-curtain" class="template">
            <label class="pure-u-1 pure-u-lg-1-4">Curtain position (0 = open to 100 = closed)</label>
            <div class="pure-u-1 pure-u-lg-1-5">
                <input class="pure-u-2-3" name="schAction" type="number" min="0" step="1" max="100" value="0">
            </div>
            <select class="pure-u-1 pure-u-lg-1-4 enumerable enumerable-curtain" name="schTarget" ></select>
            <input type="hidden" name="schType" value="3">
        </template>
        <!-- endRemoveIf(!curtain) -->

        <template id="template-relay-control">
            <div class="pure-g">
                <label class="pure-u-1 pure-u-lg-1-4"><span data-key="relayName"></span></label>
                <div><input name="relay" type="checkbox"></div>
            </div>
        </template>

        <template id="template-relay-config">
            <legend><span data-key="relayName"></span> (<span data-key="relayDesc"></span>)</legend>
            <div class="pure-g">
                <div class="pure-u-1 pure-u-lg-1-4"><label>Boot mode</label></div>
                <select class="pure-u-1 pure-u-lg-3-4" name="relayBoot">
                    <option value="0">Always OFF</option>
                    <option value="1">Always ON</option>
                    <option value="2">Same as before</option>
                    <option value="3">Toggle before</option>
                    <option value="4">Locked OFF</option>
                    <option value="5">Locked ON</option>
                </select>
            </div>
            <div class="pure-g">
                <div class="pure-u-1 pure-u-lg-1-4"><label>Pulse mode</label></div>
                <select class="pure-u-1 pure-u-lg-3-4" name="relayPulse">
                    <option value="0">Don't pulse</option>
                    <option value="1">Normally OFF</option>
                    <option value="2">Normally ON</option>
                </select>
            </div>
            <div class="pure-g">
                <div class="pure-u-1 pure-u-lg-1-4"><label>Pulse time (s)</label></div>
                <div class="pure-u-1 pure-u-lg-1-4"><input name="relayTime" class="pure-u-1" type="number" min="0" step="0.1" max="3600"></div>
            </div>
            <div class="pure-g module module-mqtt">
                <div class="pure-u-1 pure-u-lg-1-4"><label>MQTT topic subscription</label></div>
                <div class="pure-u-1 pure-u-lg-3-4"><input name="relayTopicSub" type="text" class="pure-u-1" data-action="reconnect"></div>
            </div>
            <div class="pure-g module module-mqtt">
                <div class="pure-u-1 pure-u-lg-1-4"><label>MQTT topic publish</label></div>
                <div class="pure-u-1 pure-u-lg-3-4"><input name="relayTopicPub" type="text" class="pure-u-1" data-action="reconnect"></div>
            </div>
            <div class="pure-g module module-mqtt">
                <div class="pure-u-1 pure-u-lg-1-4"><label>MQTT topic mode</label></div>
                <select class="pure-u-1 pure-u-lg-3-4" name="relayTopicMode">
                    <option value="0">Normal</option>
                    <option value="1">Inverse</option>
                </select>
            </div>
            <div class="pure-g module module-mqtt">
                <div class="pure-u-1 pure-u-lg-1-4"><label>On MQTT disconnect</label></div>
                <select class="pure-u-1 pure-u-lg-3-4" name="relayMqttDisc">
                    <option value="255">Do nothing</option>
                    <option value="0">Turn OFF</option>
                    <option value="1">Turn ON</option>
                    <option value="2">Toggle</option>
                </select>
            </div>
        </template>

        <!-- removeIf(!sensor) -->
        <template id="template-magnitude-info-form">
            <div class="pure-g">
                <label class="pure-u-1 pure-u-lg-1-4"></label>
                <div class="pure-u-1 pure-u-lg-1-4">
                    <input readonly class="pure-u-1 pure-u-lg-23-24 center" type="text" name="magnitude">
                </div>
                <div class="pure-u-1 pure-u-lg-1-2 hint center magnitude-description"></div>
                <div class="pure-u-1 pure-u-lg-1 hint magnitude-info">
                </div>
            </div>
        </template>

        <template id="template-magnitude-info">
            <div class="pure-g">
                <label class="pure-u-1 pure-u-lg-1-4"></label>
                <div class="pure-u-1 pure-u-lg-1-4">
                    <input readonly class="pure-u-1 pure-u-lg-23-24 center" type="text" name="magnitude">
                </div>
                <div class="pure-u-1 pure-u-lg-1-2 hint center magnitude-description"></div>
                <div class="pure-u-1 pure-u-lg-1 hint magnitude-info">
                </div>
            </div>
        </template>

        <template id="template-magnitude-units">
            <div class="pure-g">
                <label class="pure-u-1 pure-u-lg-1-4"></label>
                <select class="pure-u-1 pure-u-lg-1-4">
                </select>
            </div>
        </template>

        <template id="template-module-magnitude">
            <div class="pure-g">
                <label class="pure-u-1 pure-u-lg-1-4">Magnitude</label>
                <div class="pure-u-1 pure-u-lg-1-4"><input class="pure-u-1 pure-u-lg-23-24" type="number" min="0"></div>
                <div class="pure-u-1 pure-u-lg-1-2 hint center"></div>
            </div>
        </template>

        <template id="template-emon-expected">
            <div class="pure-control-group">
                <label></label>
                <div class="pure-u-1 pure-u-lg-1-4">
                    <input name="expected:" type="text" class="emon-expected-input">
                    <input readonly name="result:" type="text" class="emon-expected-result">
                </div>
                <span class="hint pure-form-message-inline emon-expected-pwrP">In Watts (W). Calibrate your sensor connecting a pure resistive load (like a bulb) and enter here its nominal power or use a multimeter.</span>
                <span class="hint pure-form-message-inline emon-expected-volt">In Volts (V). Enter your the nominal AC voltage for your household or facility, or use multimeter to get this value.</span>
                <span class="hint pure-form-message-inline emon-expected-curr">In Amperes (A). If you are using a pure resistive load like a bulb, this will be the ratio between the two previous values, i.e. power / voltage. You can also use a current clamp around one of the power wires to get this value.</span>
                <span class="hint pure-form-message-inline emon-expected-ene"></span>
            </div>
        </template>

        <template id="template-emon-ratios">
            <div class="pure-control-group">
                <label></label>
                <input type="text">
            </div>
        </template>
        <!-- endRemoveIf(!sensor) -->

        <template id="template-dcz-relay">
            <div class="pure-g">
                <label class="pure-u-1 pure-u-lg-1-4"></label>
                <div class="pure-u-1 pure-u-lg-1-4"><input class="pure-u-1 pure-u-lg-23-24" name="dczRelayIdx" type="number" min="0"></div>
            </div>
        </template>

        <template id="template-tspk-relay" class="template">
            <div class="pure-g">
                <label class="pure-u-1 pure-u-lg-1-4"></label>
                <div class="pure-u-1 pure-u-lg-1-4"><input class="pure-u-1 pure-u-lg-23-24" name="tspkRelay" type="number" min="0"></div>
            </div>
        </template>

        <!-- removeIf(!light) -->
        <template id="template-brightness-control">
            <div class="pure-g">
                <label class="pure-u-1 pure-u-lg-1-4">Brightness</label>
                <input type="range" min="0" max="255" class="slider pure-u-lg-1-4" id="brightness">
                <span class="slider brightness pure-u-lg-1-4"></span>
            </div>
        </template>

        <template id="template-channel-control">
            <div class="pure-g">
                <label class="pure-u-1 pure-u-lg-1-4">Channel #</label>
                <input type="range" min="0" max="255" class="slider channels pure-u-lg-1-4">
                <span class="slider pure-u-lg-1-4"></span>
            </div>
        </template>

        <template id="template-mireds-control">
            <div class="pure-g">
                <label class="pure-u-1 pure-u-lg-1-4">Mireds (Cold &harr; Warm)</label>
                <input type="range" min="153" max="500" class="slider pure-u-lg-1-4" id="mireds">
                <span class="slider mireds pure-u-lg-1-4"></span>
            </div>
        </template>
        <!-- endRemoveIf(!light) -->

        <!-- removeIf(!curtain) -->
        <template id="template-curtain-control">
            <div class="pure-g">
                <div class="pure-u-1-1 curtain-div">
                    <div class="curtain-roller" id="curtainGetPicture"></div>
                </div>
            </div>
            <div class="pure-g">
                <div class="pure-u-1-3 curtain-div"><button type="button" class="pure-button curtain-button button-curtain-close">CLOSE</button></div>
                <div class="pure-u-1-3 curtain-div"><button type="button" class="pure-button curtain-button button-curtain-pause">PAUSE</button></div>
                <div class="pure-u-1-3 curtain-div"><button type="button" class="pure-button curtain-button button-curtain-open">OPEN</button></div>
            </div>
            <div class="pure-g">
                <input type="range" list="tickmarks" min="0" max="100" class="slider pure-u-1-1 reverse-range" id="curtainSet">
                <datalist id="tickmarks">
                    <option value="0"></option>
                    <option value="50"></option>
                    <option value="100"></option>
                </datalist>
            </div>
        </template>
        <!-- endRemoveIf(!curtain) -->

        <!-- removeIf(!rfm69) -->
        <template id="template-rfm69-node">
            <div class="pure-g">
                <div class="pure-u-md-1-6 pure-u-1-2"><input name="rfm69Node" type="text" class="pure-u-11-12" value="" size="8" placeholder="Node ID" autocomplete="false"></div>
                <div class="pure-u-md-1-6 pure-u-1-2"><input name="rfm69Key" type="text" class="pure-u-11-12" value="" size="8" placeholder="Key"></div>
                <div class="pure-u-md-1-2 pure-u-3-4"><input name="rfm69Topic" type="text" class="pure-md-11-12 pure-u-23-24" value="" size="8" placeholder="MQTT Topic"></div>
                <div class="pure-u-md-1-6 pure-u-1-4"><button type="button" class="pure-button button-del-parent pure-u-5-6 pure-u-md-5-6">Del</button></div>
            </div>
        </template>
        <!-- endRemoveIf(!rfm69) -->

        <template id="template-rpn-rule">
            <div class="pure-g">
                <div class="pure-u-5-6"><input name="rpnRule" type="text" class="pure-u-23-24" value="" autocomplete="false"></div>
                <div class="pure-u-1-6"><button type="button" class="pure-button button-del-parent pure-u-1">Del</button></div>
            </div>
        </template>

        <template id="template-rpn-topic">
            <div class="pure-g">
                <div class="pure-u-1-2"><input name="rpnTopic" type="text" class="pure-u-23-24" value="" autocomplete="false"></div>
                <div class="pure-u-1-3"><input name="rpnName" type="text" class="pure-u-23-24" value="" autocomplete="false"></div>
                <div class="pure-u-1-6"><button type="button" class="pure-button button-del-parent pure-u-1">Del</button></div>
            </div>
        </template>

        <a href="" target="_blank" rel="noopener" id="downloader">
            Download backup .json
        </a>

        <input id="uploader" type="file">
    </body>
</html>
